# Analysis for Montipora_Spawn_Timing
Data uploaded and analyzed on Poire 
ssh hputnam@galaxy.geodata.hawaii.edu

# Upload data to server
```scp -r /Users/hputnam/MyProjects/Montipora_Spawn_Timing/Data/H_Putnam_RNA_run1-32840854 hputnam@galaxy.geodata.hawaii.edu:/home/hputnam/Mcap_Spawn/Data```

# Used the following adapter files to make barcodes file

barcodes.fasta
>TruSeq_universal_F
AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCGATGTATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACACAGTGATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCAGATCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGTAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACAGTCAAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACAGTTCCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACATGTCAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCCGTCCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCGATGTATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACACAGTGATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCATTATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCAGATCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGTAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACAGTCAAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACAGTTCCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACATGTCAATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACCCGTCCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACGTCCGCATCTCGTATGCCGTCTTCTGCTTG
>TruSeq_idx_Adapter
GATCGGAAGAGCACACGTCTGAACTCCAGTCACGTGAAAATCTCGTATGCCGTCTTCTGCTTG

#Run FASTQC
```/home/hputnam/programs/FastQC/fastqc *R1_001.fastq.gz -o /home/hputnam/Mcap_Spawn/Data/Raw_QC_Files```


#Examine FASTQC Results of raw files
```scp -r hputnam@galaxy.geodata.hawaii.edu:/home/hputnam/Mcap_Spawn/Data/Raw_QC_Files /Users/hputnam/MyProjects/Montipora_Spawn_Timing/Data/Raw_QC_Files```

#Run multicq from raw qc folder
http://multiqc.info/

```multiqc .```


#adapter trimming
### Used FastqMcf fastq-mcf sequence quality filter, clipping and processor to trim adapters.
https://code.google.com/p/ea-utils/wiki/FastqMcf
-o = output
-l = minimum remaining sequence length (=16)
-q = quality threshold causing base removal (=20)
-w = window size for quality trimming (=5)
-x = 'N' bad read percentage causing cycle removal (=10)
-u = Force disable/enable Illumina PF filtering default = auto
-P = Phred-scale default = auto

#FastqMcf 
```/home/hputnam/programs/ea-utils.1.1.2-806/fastq-mcf -l 16 -q 20 -w 5 -x 10 -u -P 33 /home/hputnam/Mcap_Spawn/Refs/barcodes.fasta /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T4-1-40299735/T4-1_S1_L001_R1_001.fastq.gz /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T4-1-40299735/T4-1_S1_L001_R2_001.fastq.gz -o /home/hputnam/Mcap_Spawn/Data/cleaned/T4-1_S1_L001_R1_001_cleaned.fastq -o /home/hputnam/Mcap_Spawn/Data/cleaned/T4-1_S1_L001_R2_001_cleaned.fastq &>T4-1.log```

```/home/hputnam/programs/ea-utils.1.1.2-806/fastq-mcf -l 16 -q 20 -w 5 -x 10 -u -P 33 /home/hputnam/Mcap_Spawn/Refs/barcodes.fasta /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T5-1-40303742/T5-1_S2_L001_R1_001.fastq.gz /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T5-1-40303742/T5-1_S2_L001_R2_001.fastq.gz -o /home/hputnam/Mcap_Spawn/Data/cleaned/T5-1_S2_L001_R1_001_cleaned.fastq -o /home/hputnam/Mcap_Spawn/Data/cleaned/T5-1_S2_L001_R2_001_cleaned.fastq &>T5-1.log```

```/home/hputnam/programs/ea-utils.1.1.2-806/fastq-mcf -l 16 -q 20 -w 5 -x 10 -u -P 33 /home/hputnam/Mcap_Spawn/Refs/barcodes.fasta /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T7-1-40300760/T7-1_S3_L001_R1_001.fastq.gz /home/hputnam/Mcap_Spawn/Data/H_Putnam_RNA_run1-32840854/T7-1-40300760/T7-1_S3_L001_R2_001.fastq.gz -o /home/hputnam/Mcap_Spawn/Data/cleaned/T7-1_S3_L001_R1_001_cleaned.fastq -o /home/hputnam/Mcap_Spawn/Data/cleaned/T7-1_S3_L001_R2_001_cleaned.fastq &>T7-1.log```


#Run Fastqc on cleaned files
```/home/hputnam/programs/FastQC/fastqc /home/hputnam/Mcap_Spawn/Data/cleaned/*.fastq -o /home/hputnam/Mcap_Spawn/Data/cleaned_QC_Files```

#Examine FASTQC Results of cleaned files
```scp -r hputnam@galaxy.geodata.hawaii.edu:/home/hputnam/Mcap_Spawn/Data/cleaned_QC_Files /Users/hputnam/MyProjects/Montipora_Spawn_Timing/Data/cleaned_QC_Files```

#Concatenate R1
cat /home/hputnam/Mcap_Spawn/Data/cleaned/*cleaned.fastq  all_R2_clean.fastq

#Run Trinity de novo assembly
```/home/hputnam/programs/trinityrnaseq-2.2.0/Trinity --seqType fq  --left /home/hputnam/Mcap_Spawn/Data/cleaned/all_R1_clean.fastq --right /home/hputnam/Mcap_Spawn/Data/cleaned/all_R2_clean.fastq --CPU 20 --max_memory 20G  --min_contig_length 200``` 

#Run BSUSCO on Trinity.fasta http://
* busco.ezlab.org/files/BUSCO_userguide.pdf

#Assessing genome assembly and annotation completeness with Benchmarking Universal Single-Copy Orthologs
test
python /home/hputnam/programs/BUSCO_v1.22/BUSCO_v1.22.py -o Test_BUSCO -in /home/hputnam/Hawaii_Mcap/trinity_out_dir/Trinity.fasta -l /home/hputnam/programs/BUSCO_v1.22/metazoa -m trans


python /home/hputnam/programs/BUSCO_v1.22/BUSCO_v1.22.py -o Mcap_Spawn_BUSCO -in Trinity.fasta -l /home/hputnam/programs/BUSCO_v1.22/metazoa -m trans

